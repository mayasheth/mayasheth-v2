---
// src/components/Navigation.astro
import { Icon } from "astro-icon/components";
import SearchButton from "@/components/search/SearchButton.astro";
import MobileMenu from "@/components/layout/MobileMenu.astro";
import SearchModal from "@/components/search/SearchModal.astro";
import { NAV_ITEMS } from "@/data/navData";

const navbarClasses =
  "flex items-center soft-transition group-hover:font-semibold group-hover:text-content-2 focus-outline-rounded";
const dropdownClasses =
  "block px-4 py-1 font-header soft-transition hover:font-semibold hover:text-content-2 focus-outline";
---

<header class="bg-surface-2 sticky top-0 z-50 p-3">
  <div class="mx-auto flex max-w-6xl items-center justify-between">
    <!-- Left: Logo and site Name -->
    <div class="flex items-end justify-center">
      <img class="-mb-0.5 h-auto w-8" src="/tricolor-paw.svg" alt="paw-logo" />
      <a
        href="/"
        class="text-content-3 soft-transition hover:text-content-2 focus-outline-rounded ml-2 font-serif text-xl font-bold"
        >maya sheth</a
      >
    </div>

    <!-- Desktop menu -->
    <nav
      class="font-header text-content-3 hidden items-center space-x-6 text-base font-light tracking-wide md:flex"
    >
      {
        NAV_ITEMS.map((item) => (
          <div class="group relative">
            <button class={navbarClasses}>
              {item.label}
              {item.icon && (
                <Icon
                  name={item.icon}
                  class="soft-transition ml-1 h-4 w-4 group-hover:-scale-100"
                />
              )}
            </button>
            <div class="bg-surface-1 ring-surface-3 absolute left-1/2 my-2 hidden w-auto -translate-x-1/2 rounded-md py-1 text-center ring-2 group-hover:block before:absolute before:inset-x-0 before:-top-2 before:h-2 before:content-['']">
              {item.children.map((child) => (
                <a href={child.href} class={dropdownClasses}>
                  {child.label}
                </a>
              ))}
            </div>
          </div>
        ))
      }
      <!-- Search button (desktop) -->
      <SearchButton id="search-trigger" />
    </nav>

    <!-- MOBILE: header icons only (search + menu), right aligned -->
    <MobileMenu navItems={NAV_ITEMS} mode="icons" />
  </div>

  <!-- MOBILE: dropdown menu (always below header bar), hidden on desktop -->
  <MobileMenu navItems={NAV_ITEMS} mode="dropdown" />

  <!-- Search modal -->
  <SearchModal />
</header>
